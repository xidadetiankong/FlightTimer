<!-- pages/nineHundred/nineHundred.wxml -->
<view class="container" id="container-area">
  <!-- 新增功能按钮组 - 放置在最顶部 -->
  <view class="function-bar-top">
    <view class="function-bar-inner">
      <input type="number" class="jump-input" placeholder="890" model:value="{{jumpToIndex}}" bindinput="validateJumpInput" catchtap="stopPropagation" />
      <button class="func-btn jump-btn" catchtap="handleJumpTo">跳转</button>
      <button class="func-btn favorites-btn {{showOnlyFavorites ? 'active' : ''}}" catchtap="toggleShowOnlyFavorites">仅看收藏</button>
    </view>
  </view>



  <!-- 学习卡片主体 -->
  <view class="study-card">
    <!-- 卡片头部信息 -->
    <view class="card-header">
      <view class="meta-item">
        <text class="meta-label">序号</text>
        <text class="meta-value">{{currentSentence.id}}</text>
      </view>
      <view class="meta-item">
        <text class="meta-label">等级</text>
        <text class="meta-value level-{{currentSentence.level}}">{{currentSentence.level}}</text>
      </view>
      <view class="meta-item">
        <text class="meta-label">词数</text>
        <text class="meta-value">{{currentSentence.wordCount}}</text>
      </view>
    </view>

    <!-- 学习内容区域 -->
    <view class="card-body">
      <view class="sentence-en">{{currentSentence.sentence}}</view>

      <!-- 翻译分割线 -->
      <view class="divider">
        <view class="divider-line"></view>
        <text class="divider-text">译文</text>
        <view class="divider-line"></view>
      </view>

      <view class="sentence-cn">{{currentSentence.translation}}</view>
    </view>
  </view>

  <!-- 操作按钮组 -->
  <view class="action-bar">
    <!-- 进度条模块 - 放在底部按钮内部上方 -->
    <view class="progress-bar-inside">
      <view class="progress-track" catchtap="handleProgressBarTap" bindtouchmove="handleProgressBarDrag" bindtouchstart="handleProgressBarDragStart" bindtouchend="handleProgressBarDragEnd">
        <view
          class="progress-indicator"
          style="width: {{(currentIndex + 1)/(showOnlyFavorites ? filteredSentences.length : sentences.length) * 100}}%"
        >
          <view class="progress-handle"></view>
        </view>
      </view>
      <text class="progress-text">进度：{{currentIndex + 1}}/{{showOnlyFavorites ? filteredSentences.length : sentences.length}}</text>
    </view>

    <!-- 按钮行 -->
    <view class="button-row">
      <button
        class="btn prev"
        catchtap="handlePageTurn"
        data-type="prev"
        disabled="{{currentIndex === 0}}"
      >〈 上一句</button>

      <view
        class="collect btn {{isCollected ? 'active' : ''}}"
        catchtap="toggleCollect"
      >{{isCollected ? '★ 已收藏' : '☆ 收藏'}}</view>

      <!-- <button
        class="btn collect"
        catchtap="toggleCollect"
        style="background:{{collected.has(sentences[currentIndex].id) ? '#FFD700' : '#F5F5F5'}}"
      >{{collected.has(sentences[currentIndex].id) ? '★ 已收藏' : '☆ 收藏'}}</button> -->

      <button
        class="btn next"
        catchtap="handlePageTurn"
        data-type="next"
        disabled="{{currentIndex === (showOnlyFavorites ? filteredSentences.length - 1 : sentences.length - 1)}}"
      >下一句 〉</button>
    </view>


  </view>


</view>
